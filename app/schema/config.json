{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/flux-eco/flux-eco-http-server/main/app/config/config.json",
  "definitions": {
    "serverConfig": {
      "type": "object",
      "properties": {
        "port": {
          "type": "string",
          "pattern": "^[0-9]+$"
        },
        "host": {
          "type": "string"
        }
      },
      "required": [
        "port",
        "host"
      ]
    },
    "policiesConfig": {
      "type": "object",
      "properties": {
        "allowedHeaders": {
          "type": "string"
        },
        "allowedIps": {
          "type": "string"
        }
      }
    },
    "staticEndpointConfig": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "method": {
          "type": "string",
          "enum": [
            "GET",
            "POST",
            "PUT",
            "DELETE"
          ]
        },
        "path": {
          "type": "string"
        },
        "response": {
          "type": "object",
          "properties": {
            "description": {
              "type": "string"
            },
            "type": {
              "type": "string",
              "enum": [
                "string",
                "number",
                "object",
                "array"
              ]
            }
          },
          "required": [
            "description",
            "type"
          ]
        }
      },
      "required": [
        "name",
        "description",
        "method",
        "path",
        "response"
      ]
    },
    "apiEndpointConfig": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "method": {
          "type": "string",
          "enum": [
            "GET",
            "POST",
            "PUT",
            "DELETE"
          ]
        },
        "path": {
          "type": "string"
        },
        "apiName": {
          "type": "string"
        },
        "apiAction": {
          "type": "string"
        }
      },
      "required": [
        "name",
        "description",
        "method",
        "path",
        "apiName",
        "apiAction"
      ]
    }
  },
  "type": "object",
  "properties": {
    "endpoints": {
      "type": "object",
      "properties": {
        "http": {
          "type": "object",
          "properties": {
            "server": {
              "$ref": "#/definitions/serverConfig"
            },
            "policies": {
              "$ref": "#/definitions/policiesConfig"
            },
            "static": {
              "$ref": "#/definitions/staticEndpointConfig"
            },
            "actions": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/apiEndpointConfig"
              }
            }
          },
          "required": [
            "server",
            "policies",
            "static",
            "actions"
          ]
        }
      },
      "required": [
        "http"
      ]
    },
    "bindings": {
      "type": "object",
      "properties": {
        "backend": {
          "type": "object",
          "properties": {
            "server": {
              "type": "object",
              "properties": {
                "port": {
                  "type": "number"
                },
                "host": {
                  "type": "string"
                }
              },
              "required": [
                "port",
                "host"
              ]
            },
            "boundActions": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "path": {
                    "type": "string"
                  },
                  "targetPath": {
                    "type": "string"
                  },
                  "middlewareClass": {
                    "type": "string",
                    "enum": [
                      "ActionMiddleware",
                      "BackendProxyMiddleware",
                      "ConfigMiddleware",
                      "ErrorHandlingMiddleware",
                      "LoggerMiddleware",
                      "LoggingMiddleware",
                      "PoliciesMiddleware",
                      "RequestContentLoggerMiddleware",
                      "ResponseContentLoggerMiddleware",
                      "ServerMiddleware",
                      "StaticFileMiddleware"
                    ]
                  }
                },
                "required": [
                  "path",
                  "targetPath",
                  "middlewareClass"
                ]
              }
            }
          },
          "required": [
            "server",
            "boundActions"
          ]
        }
      }
    }
  },
  "required": [
    "endpoints",
    "bindings"
  ]
}